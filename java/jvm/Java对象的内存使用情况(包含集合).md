# Java 进程的内存使用

当运行一个Java应用程序时，Java 运行时会创建一个操作系统进程，作为操作系统进程，Java 运行时面临着与其他进程完全相同的内存限制
架构提供的内存寻址能力依赖于处理器的位数，举例来说，32位或者64位进程能够处理的位数决定了处理器能寻址的内存范围：32位提供了 $$2^{32}$$ 的可寻址范围，也就是 4,294,967,296 位，或者说 4GB。而 64 位处理器的可寻址范围明显增大：$$2^{64}$$，也就是 18,446,744,073,709,551,616。

OS和C运行时占用的内存数量取决于所用的OS，但通常数量较大:Windows 默认占用的内存是2GB。剩余的可寻址空间就是可供运行的实际进程使用的内存。

对于 Java 应用程序，**用户空间是 Java 进程占用的内存**，实际上包含两个池：Java 堆和本机（非 Java，堆外内存）堆。Java 堆的大小由  JVM 的 Java 堆设置控制：-Xms 和 -Xmx 分别设置最小和最大 Java 堆。在按照最大的大小设置分配了 Java 堆之后，剩下的用户空间就是本机堆。下面展示了一个 32 位 Java 进程的内存布局

可寻址范围总共有 4GB，OS 和 C 运行时大约占用了其中的 1GB，Java 堆占用了将近 2GB，本机堆占用了其他部分。请注意，JVM 本身也要占用内存，就像 OS 内核和 C 运行时一样，而 JVM 占用的内存是本机堆的子集。